import{_ as a,o as e,c as s,X as o}from"./chunks/framework.85f88ea4.js";const C=JSON.parse('{"title":"GM world rollup: Deploying to Celestia","description":"","frontmatter":{"head":[["meta",{"name":"og:title","content":"GM world rollup: Deploying to Celestia | Rollkit"},{"name":"og:description","content":false}]]},"headers":[],"relativePath":"tutorials/celestia-da.md","filePath":"tutorials/celestia-da.md","lastUpdated":1716392459000}'),n={name:"tutorials/celestia-da.md"},l=o(`<h1 id="gm-world-rollup-deploying-to-celestia" tabindex="-1">GM world rollup: Deploying to Celestia <a class="header-anchor" href="#gm-world-rollup-deploying-to-celestia" aria-label="Permalink to &quot;GM world rollup: Deploying to Celestia&quot;">‚Äã</a></h1><h2 id="introduction" tabindex="-1">üåû Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;üåû Introduction {#introduction}&quot;">‚Äã</a></h2><p>This tutorial serves as a comprehensive guide for deploying your GM world rollup on Celestia&#39;s data availability (DA) network. From the Rollkit perspective, there&#39;s no difference in posting blocks to Celestia&#39;s testnets or Mainnet Beta.</p><p>Before proceeding, ensure that you have completed the <a href="/tutorials/gm-world">GM world rollup</a> tutorial, which covers setting up a local sovereign gm-world rollup and connecting it to a local (mock) DA node.</p><h2 id="ü™∂-running-a-celestia-light-node" tabindex="-1">ü™∂ Running a Celestia light node <a class="header-anchor" href="#ü™∂-running-a-celestia-light-node" aria-label="Permalink to &quot;ü™∂ Running a Celestia light node&quot;">‚Äã</a></h2><p>Before you can start your rollup node, you need to initiate, sync, and possibly fund a light node on one of Celestia&#39;s networks:</p><ul><li><a href="https://docs.celestia.org/nodes/arabica-devnet" target="_blank" rel="noreferrer">Arabica Devnet</a></li><li><a href="https://docs.celestia.org/nodes/mocha-testnet" target="_blank" rel="noreferrer">Mocha Testnet</a></li><li><a href="https://docs.celestia.org/nodes/mainnet" target="_blank" rel="noreferrer">Mainnet Beta</a></li></ul><p>The main difference lies in how you fund your wallet address: using testnet TIA or <a href="https://docs.celestia.org/learn/tia#overview-of-tia" target="_blank" rel="noreferrer">TIA</a> for Mainnet Beta.</p><p>After successfully starting a light node, it&#39;s time to start posting the batches of blocks of data that your rollup generates.</p><h2 id="üßπ-cleaning-previous-chain-history" tabindex="-1">üßπ Cleaning previous chain history <a class="header-anchor" href="#üßπ-cleaning-previous-chain-history" aria-label="Permalink to &quot;üßπ Cleaning previous chain history&quot;">‚Äã</a></h2><p>From the <a href="/tutorials/gm-world">GM world rollup</a> tutorial, you should already have the <code>gmd</code> binary and the <code>$HOME/.gm</code> directory.</p><p>To clear old rollup data:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-r</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/local/bin/gmd</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> $HOME</span><span style="color:#C3E88D;">/.gm</span></span></code></pre></div><h2 id="üèóÔ∏è-building-your-rollup" tabindex="-1">üèóÔ∏è Building your rollup <a class="header-anchor" href="#üèóÔ∏è-building-your-rollup" aria-label="Permalink to &quot;üèóÔ∏è Building your rollup&quot;">‚Äã</a></h2><p>Now we need to rebuild our rollup by simply running the existing <code>init.sh</code> script:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> $HOME</span><span style="color:#C3E88D;">/gm</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">init.sh</span></span></code></pre></div><p>This process creates a new <code>$HOME/.gm</code> directory and a new <code>gmd</code> binary. Next, we need to connect our rollup to the running Celestia light node.</p><h2 id="üõ†Ô∏è-configuring-flags-for-da" tabindex="-1">üõ†Ô∏è Configuring flags for DA <a class="header-anchor" href="#üõ†Ô∏è-configuring-flags-for-da" aria-label="Permalink to &quot;üõ†Ô∏è Configuring flags for DA&quot;">‚Äã</a></h2><p>Now we&#39;re prepared to initiate our rollup and establish a connection with the Celestia light node. The <code>gmd start</code> command requires three DA configuration flags:</p><ul><li><code>--rollkit.da_start_height</code></li><li><code>--rollkit.da_auth_token</code></li><li><code>--rollkit.da_namespace</code></li></ul><p>Let&#39;s determine what to provide for each of them.</p><p>First, let&#39;s query the DA Layer start height using an RPC endpoint provided by Celestia Labs. For Mocha testnet it would be - <a href="https://rpc-mocha.pops.one/block" target="_blank" rel="noreferrer">https://rpc-mocha.pops.one/block</a>, and for mainnet beta - <a href="https://rpc.lunaroasis.net/block" target="_blank" rel="noreferrer">https://rpc.lunaroasis.net/block</a></p><p>Here is an example for the Mocha testnet (replace URL for mainnet beta if needed):</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">DA_BLOCK_HEIGHT</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> https://rpc-mocha.pops.one/block </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">jq</span><span style="color:#C3E88D;"> -r </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.result.block.header.height</span><span style="color:#89DDFF;">&#39;)</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-e</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\\n Your DA_BLOCK_HEIGHT is </span><span style="color:#A6ACCD;">$DA_BLOCK_HEIGHT</span><span style="color:#C3E88D;"> \\n</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>You will see the output like this:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Your</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DA_BLOCK_HEIGHT</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1777655</span></span></code></pre></div><p>Now, obtain an authentication token for your light node as follows (for Mainnet Beta, simply omit the --p2p.network flag):</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">AUTH_TOKEN</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">celestia</span><span style="color:#C3E88D;"> light auth write --p2p.network mocha</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-e</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\\n Your DA AUTH_TOKEN is </span><span style="color:#A6ACCD;">$AUTH_TOKEN</span><span style="color:#C3E88D;"> \\n</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>The output will look like this:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Your</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DA</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">AUTH_TOKEN</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBbGxvdyI6WyJwdWJsaWMiLCJyZWFkIiwid3JpdGUiXX0.cSrJjpfUdTNFtzGho69V0D_8kyECn9Mzv8ghJSpKRDE</span></span></code></pre></div><p>Now, let&#39;s also set up a namespace for our blocks by simply setting a variable like this:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">DA_NAMESPACE</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">00000000000000000000000000000000000000000008</span><span style="color:#C3E88D;">e5f679bf7116cb</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>00000000000000000000000000000000000000000008e5f679bf7116cb</code> is a default namespace for Mocha testnet. You can set your own by using a command similar to this (or, you could get creative üòé):</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">openssl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rand</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-hex</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span></span></code></pre></div><p>Replace the last 20 characters (10 bytes) in <code>00000000000000000000000000000000000000000008e5f679bf7116cb</code> with the newly generated 10 bytes.</p><p><a href="https://docs.celestia.org/developers/node-tutorial#namespaces" target="_blank" rel="noreferrer">Learn more about namespaces</a>.</p></div><h2 id="üî•-running-your-rollup-connected-to-a-celestia-light-node" tabindex="-1">üî• Running your rollup connected to a Celestia light node <a class="header-anchor" href="#üî•-running-your-rollup-connected-to-a-celestia-light-node" aria-label="Permalink to &quot;üî• Running your rollup connected to a Celestia light node&quot;">‚Äã</a></h2><p>Now let&#39;s run our rollup node with all DA flags:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">gmd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">--rollkit.aggregator</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">--rollkit.da_auth_token</span><span style="color:#A6ACCD;"> $AUTH_TOKEN \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">--rollkit.da_namespace</span><span style="color:#A6ACCD;"> $DA_NAMESPACE \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">--rollkit.da_start_height</span><span style="color:#A6ACCD;"> $DA_BLOCK_HEIGHT \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">--minimum-gas-prices=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0.025stake</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>Now, the rollup is running and posting blocks (aggregated in batches) to Celestia. You can view your rollup by finding your namespace or account on <a href="https://docs.celestia.org/nodes/mocha-testnet#explorers" target="_blank" rel="noreferrer">Mocha testnet</a> or <a href="https://docs.celestia.org/nodes/mainnet#explorers" target="_blank" rel="noreferrer">mainnet beta</a> explorers.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>For details on configuring gas prices specifically for the DA network, see our <a href="/guides/gas-price">DA Network Gas Price Guide</a>. This is separate from the <code>--minimum-gas-prices=&quot;0.025stake&quot;</code> setting, which is used for rollup network operations.</p></div><h2 id="üéâ-next-steps" tabindex="-1">üéâ Next steps <a class="header-anchor" href="#üéâ-next-steps" aria-label="Permalink to &quot;üéâ Next steps&quot;">‚Äã</a></h2><p>Congratulations! You&#39;ve built a local rollup that posts to Celestia&#39;s testnets or Mainnet Beta. Well done! Now, go forth and build something great! Good luck!</p>`,40),t=[l];function r(p,i,c,d,h,u){return e(),s("div",null,t)}const g=a(n,[["render",r]]);export{C as __pageData,g as default};
